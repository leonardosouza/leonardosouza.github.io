<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
  
  <title>Archives: 2014 | leonardo souza</title>
  <meta property="og:title" content="Archives: 2014 | leonardo souza">
  <meta property="og:type" content="article">
  <meta property="og:url" content="http://www.leonardosouza.com.br/">
  <meta property="og:image" content="http://www.leonardosouza.com.br/img/eu.png">
  <meta property="og:site_name" content="Leonardo Souza">
  <meta property="fb:admins" content="1006450660">
  <meta property="fb:app_id" content="205471216228123">




  <meta name="author" content="Leonardo Souza">
  
  <meta name="description" content="js, html, css e outras bobeiras">
  <meta property="og:description" content="js, html, css e outras bobeiras">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="leonardo souza"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="leonardo souza" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48028121-1', 'leonardosouza.com.br');
  ga('send', 'pageview');
</script>

</head>

<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">leonardo souza</a></h1>
  <h2><a href="/">front-end engineer</a></h2>
</div>
<nav id="main-nav">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/about">About</a></li>
    
      <li><a href="/atom.xml">Rss</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
<div class="alignleft" style="margin-top: 15px">


</div>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="wrapper">
<h2 class="archive-title">2014</h2>


  
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/organize-seu-codigo-javascript-de-maneira-facil/">Organize seu código Javascript de maneira fácil!</a></h1>
  

      
        <p class="published">
          Published: <time datetime="2014-03-10T03:00:00.000Z">Mar 10 2014</time>
        </p>
      
    </header>
    <div class="entry">
      
        <p><img src="http://blog.caelum.com.br/wp-content/uploads/2014/02/js.jpg" alt="" width="552" height="222" style="display:block;margin:auto;" /></p>
<p>Ao longo desses anos nesta indústria vital já participei de inúmeros projetos... e foram tantos que os dedos das mãos seriam insuficientes para contá-los. Alguns deles me orgulho, outros nem tanto (afinal como você, eu também já produzi muita coisa de qualidade duvidosa). Ainda assim acredito na máxima que as pessoas sempre evoluem, uma vez que estas buscam sempre o melhor dentro da missão de cada uma.</p>
<p>Organizar código Javascript para quem está iniciando nem sempre é fácil, pois na ótica do programador novato a linguagem é o mesmo que um monte de blocos de código (leia funções) que este foi criando ou até mesmo copiando para resolver os problemas do dia-a-dia. Esse pensamento, somado a inúmeras más práticas vão tornando o código feito com Javascript um tanto que caótico.</p>
<p>Entre as principais (más práticas), eis algumas que a meu ver atrapalham e irritam grande parte dos membros de um time de desenvolvimento (ah e faz a mãe do programador, ser lembrada):</p>
<ul>
    <li>falta de indentação</li>
    <li>falta de comentários</li>
    <li>variáveis espalhadas</li>
    <li>variáveis globais</li>
    <li>funções e variáveis criadas sem propósito</li>
</ul>

<p>Mas o objetivo deste artigo não é só citar as partes ruins do desenvolvimento, e sim propor uma forma elegante de resolver isso. Então vamos a uma solução simples para organização dos seus códigos feitos com JavaScript.</p>
<h2 id="fun-es-nomeadas-x-fun-es-an-nimas">Funções nomeadas x funções anônimas</h2>
<p>Todo mundo aqui, deve saber o que são funções <strong>nomeadas</strong> e <strong>anônimas</strong> em JavaScript. Se não sabe, eis alguns exemplos:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="comment">// função nomeada</span>
<span class="function"><span class="keyword">function</span> <span class="title">common</span><span class="params">()</span> {</span>
    <span class="keyword">return</span> <span class="literal">true</span>;
}
</pre></td></tr></table></figure>

<p>Acima vemos uma <strong>função nomeada</strong> e, a seguir, uma <strong>função anônima</strong>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="comment">// função anônima</span>
<span class="keyword">var</span> anonymous = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
 <span class="keyword">return</span> <span class="literal">true</span>;
}
</pre></td></tr></table></figure>

<p>Observando os dois códigos, vê-se pouca diferença, não é mesmo? Os dois quando executados retornam a mesma coisa (true), porém são padrões sintáticos bem distintos.</p>
<p>No primeiro, temos uma função definida com o nome <strong>common</strong>, e é através desse nome que será possível invocar essa função, desse jeito:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>common();
<span class="comment">// =&gt; true</span>
</pre></td></tr></table></figure>

<p>No segundo, note que a função não possui um nome, então ela precisou ser atribuída a variável <strong>anonymous</strong> para que pudesse ser invocada. Neste caso a chamada seria idêntica ao exemplo anterior:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>anonymous();
<span class="comment">// =&gt; true</span>
</pre></td></tr></table></figure>

<p>Entendeu o conceito? Em linhas gerais, desculpe a ambiguidade, a <strong>função nomeada</strong> chama-se assim porque <strong>tem um nome</strong>. A <strong>função anônima</strong>, por sua vez <strong>não possui um nome</strong>, então a única forma de utilizá-la é atribuindo-a algo (uma variável, uma propriedade em um objeto, etc). Perdi esse tempo, explicando isso, pois acho que vai valer a pena para você entender o que vamos fazer a seguir.</p>
<h2 id="come-ando-a-organiza-o">Começando a organização</h2>
<p>Vamos iniciar os trabalhos, <strong>criando uma função anônima</strong>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>}
</pre></td></tr></table></figure>

<p>Se você salvar esse código e tentar e xecutá-lo em sua página, ou mesmo rodá-lo no console do seu navegador tomará um <strong><em>SyntaxError</em></strong>. E isso tem um motivo óbvio, pois se a função não tem nome como eu vou chamá-la? Então teoricamente eu seria obrigado a atribui-la a uma variável ou algo do tipo. Neste caso, vamos fazer diferente:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>})
</pre></td></tr></table></figure>

<p>Colocando esse código entre parênteses, o <strong><em>SyntaxError</em></strong> que estava rolando até então sumirá. Mágica? Magia negra? Não! Simplesmente os parênteses agruparam a nossa função, formando uma espécie de expressão. Esse código servirá de embrulho (<strong>wrapper</strong>) para tudo que vamos fazer daqui pra frente. Farei um pequeno teste agora, colocando um simpático <code>console.log</code> dentro da nossa função e, se tudo der certo, o resultado será a exibição do texto <strong>&quot;less is more!&quot;</strong>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
 console.log(<span class="string">"less is more!"</span>);
})
</pre></td></tr></table></figure>

<p>Se você executou esse código na sua página, e deu uma olhadinha no console, vai perceber que não houve retorno algum. Ué, o que que houve? Ocorre que apesar de termos uma função que implementa uma única linha de código, ele só está definida, porém não foi executada. Para fazer isso, basta adicionar parênteses no final da expressão, desta forma:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
 console.log(<span class="string">"less is more!"</span>);
})();
</pre></td></tr></table></figure>

<p>Bingo! A partir de agora, toda vez que a página for carregada, esse função será executada &quot;automagicamente&quot;! Então temos a base necessária para organização de nossos códigos.</p>
<h2 id="organizando-seu-c-digo">Organizando seu código</h2>
<p>Você já deve ter ouvido falar, que toda variável precisa ser declarada usando a palavra chave <strong>var</strong>. Não usar o <strong>var</strong>, custa caro, pois uma variável definida sem ele vai parar no <strong>escopo global</strong>, então para seguir a régua de boas práticas vamos sempre usá-lo.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    console.log(<span class="string">"less is more!"</span>);

    <span class="keyword">var</span> box = {};

})();
</pre></td></tr></table></figure>

<p>No exemplo acima, defini uma variável <strong>box</strong> que armazena um <strong>objeto vazio</strong>. A grande vantagem dessa abordagem é que <strong>box</strong> não está disponível em nenhum outro escopo a não ser o definido pela função <strong>wrapper</strong> que fizemos. Então se algum espertinho tentar ir no console e digitar:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>console.log(box);
<span class="comment">// =&gt; ReferenceError: box is not defined</span>
</pre></td></tr></table></figure>

<p>Vai tomar um belo de um <strong><em>ReferenceError</em></strong> no meio da cara! Bom né? Não sujamos o escopo global e ainda ganhamos privacidade! :D</p>
<p>Uma vez que temos o objeto <strong>box</strong>, podemos adicionar propriedades e métodos a este objeto. Imagine agora que precisamos criar um controle bem simples, para organizar uma fila com nomes de automóveis. A ideia é começar com a fila vazia, ir adicionando os veículos e retornar a lista no final. Para isso, vamos usar uma propriedade chamada <strong>queue</strong> e dois métodos, que vamos chamar de <strong>addItem</strong> e <strong>getQueue</strong>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="code"><pre>(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    console.log(<span class="string">"less is more!"</span>);

    <span class="comment">// criando o objeto (vazio) box</span>
    <span class="keyword">var</span> box = {};

    <span class="comment">// adicionando a propriedade queue (fila)</span>
    box.queue = [];

    <span class="comment">// adicionando o métodos addItem (adicionar item)</span>
    box.addItem = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>

    };

    <span class="comment">// adicionando o métodos getQueue (recuperar fila)</span>
    box.getQueue = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>

    };
})();
</pre></td></tr></table></figure>

<p>Como podemos perceber, a propriedade <strong>queue</strong> é um array vazio. Então nosso método <strong>addItem</strong> precisa receber um veículo como parâmetro e adicioná-lo nesta fila. Por sua vez, o método <strong>getQueue</strong> apenas retorna uma string com os veículos que temos na fila, separados por um hífen.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="code"><pre>(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    console.log(<span class="string">"less is more!"</span>);

    <span class="comment">// criando o objeto (vazio) box</span>
    <span class="keyword">var</span> box = {};

    <span class="comment">// adicionando a propriedade queue (fila)</span>
    box.queue = [];

    <span class="comment">// adicionando o métodos addItem (adicionar item)</span>
    box.addItem = <span class="function"><span class="keyword">function</span><span class="params">(car)</span> {</span>
        <span class="keyword">return</span> box.queue.push(car);
    };

    <span class="comment">// adicionando o métodos getQueue (recuperar fila)</span>
    box.getQueue = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="keyword">return</span> box.queue.join(<span class="string">" - "</span>);
    };
})();
</pre></td></tr></table></figure>

<p>Feito isso, se você rodar esse código, deve estar se perguntando: como diabos vou invocar os métodos <strong>addItem</strong> e <strong>getQueue</strong> do objeto <strong>box</strong> que acabei de implementar, visto que ele não está acessível no escopo global? A resposta é simples, basta fazer com que nossa função <strong>wrapper</strong> retorne o objeto <strong>box</strong> (forma simples) ou podemos configurar exatamente o que vai ser retornado. Vamos ao primeiro exemplo:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="keyword">var</span> GLOBALCAR = (<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    console.log(<span class="string">"less is more!"</span>);

    <span class="comment">// criando o objeto (vazio) box</span>
    <span class="keyword">var</span> box = {};

    <span class="comment">// adicionando a propriedade queue (fila)</span>
    box.queue = [];

    <span class="comment">// adicionando o métodos addItem (adicionar item)</span>
    box.addItem = <span class="function"><span class="keyword">function</span><span class="params">(car)</span> {</span>
        <span class="keyword">return</span> box.queue.push(car);
    };

    <span class="comment">// adicionando o métodos getQueue (recuperar fila)</span>
    box.getQueue = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="keyword">return</span> box.queue.join(<span class="string">" - "</span>);
    };

    <span class="keyword">return</span> box;
})();
</pre></td></tr></table></figure>

<p>Como você deve ter percebido, além de retornar o objeto <strong>box</strong>, eu atribui o nosso <strong>wrapper</strong> a uma variável global chamada <strong>GLOBALCAR</strong> (mesmo com a palavra chave var, como <strong>GLOBALCAR</strong> não está dentro de uma função, ela fica visível no escopo mais amplo do Javascript, podendo ser acessada de qualquer local). Dessa forma, <strong>GLOBALCAR</strong> tornou-se um objeto. Para testar nossa implementação podemos executar (eu incentivo você neste momento a testar via console):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>GLOBALCAR;
<span class="comment">// =&gt; Object {queue: Array[0], addItem: function, getQueue: function}</span>
</pre></td></tr></table></figure>

<p>Viu isso? <strong>GLOBALCAR</strong> é um objeto contendo <strong>queue</strong>, <strong>addItem</strong> e <strong>getQueue</strong>. Então podemos executar o método <strong>addItem</strong> para adicionar os carros a nossa fila:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>GLOBALCAR.addItem(<span class="string">"Gol"</span>);
<span class="comment">// =&gt; 1</span>
GLOBALCAR.addItem(<span class="string">"Palio"</span>);
<span class="comment">// =&gt; 2</span>
GLOBALCAR.addItem(<span class="string">"Corsa"</span>);
<span class="comment">// =&gt; 3</span>
</pre></td></tr></table></figure>

<p>E o método <strong>getQueue</strong> para retornar os itens que estão na fila:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>GLOBALCAR.getQueue();
<span class="comment">// =&gt; "Gol - Palio - Corsa"</span>
</pre></td></tr></table></figure>

<p>Legal né? Mas ai se você souber um pouquinho mais de JavaScript vai se perguntar porque é possível acessar a propriedade <strong>queue</strong> diretamente!? Isso tem tudo a ver com a forma que retornamos o objeto <strong>box</strong>. Se você quiser esconder essa propriedade, deixando disponível apenas os métodos você pode fazer isso:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="code"><pre><span class="keyword">var</span> GLOBALCAR = (<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    console.log(<span class="string">"less is more!"</span>);

    <span class="comment">// criando o objeto (vazio) box</span>
    <span class="keyword">var</span> box = {};

    <span class="comment">// adicionando a propriedade queue (fila)</span>
    box.queue = [];

    <span class="comment">// adicionando o métodos addItem (adicionar item)</span>
    box.addItem = <span class="function"><span class="keyword">function</span><span class="params">(car)</span> {</span>
        <span class="keyword">return</span> box.queue.push(car);
    };

    <span class="comment">// adicionando o métodos getQueue (recuperar fila)</span>
    box.getQueue = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="keyword">return</span> box.queue.join(<span class="string">" - "</span>);
    };

    <span class="comment">// retornando um objeto personalizado (só com o necessário)</span>
    <span class="keyword">return</span> {
        add: box.addItem,
        get: box.getQueue
    };
})();
</pre></td></tr></table></figure>

<p>Agora um novo teste no console revelará:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>GLOBALCAR;
<span class="comment">// =&gt; Object {add: function, get: function}</span>
</pre></td></tr></table></figure>

<p>Note que ninguém, a não ser você saberá da existência da propriedade <strong>queue</strong>. O mesmo vale para outros métodos que você queira implementar, mais que não fazem sentido serem expostos.</p>
<p>Com base na nova implementação, o método <strong>addItem</strong> virou apenas <strong>add</strong>, e o <strong>getQueue</strong> virou um simples <strong>get</strong>. Para adicionar itens a nossa fila, usaremos então:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>GLOBALCAR.add(<span class="string">"Gol"</span>);
<span class="comment">// =&gt; 1</span>
GLOBALCAR.add(<span class="string">"Palio"</span>);
<span class="comment">// =&gt; 2</span>
GLOBALCAR.add(<span class="string">"Corsa"</span>);
<span class="comment">// =&gt; 3</span>
</pre></td></tr></table></figure>

<p>E para retornar a fila:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>GLOBALCAR.get();
<span class="comment">// =&gt; "Gol - Palio - Corsa"</span>
</pre></td></tr></table></figure>

<p>Elegante não? Agora você já tem uma base sólida para começar a organizar os seus projetos em JavaScript. O mais bacana, é que você pode entender a timeline do processo para chegarmos nesse objetivo. Aproveite o momento de satisfação, e divulge para a galera que agora você aprendeu a usar um <strong>pattern</strong> para organização do seu código, conhecido por aí como &quot;<strong>Module Pattern</strong>&quot;. Chique não?</p>
<p><em>Este artigo foi originalmente publicado no site <a href="http://blog.caelum.com.br/organize-seu-codigo-javascript-de-maneira-facil/" target="_blank"><a href="http://blog.caelum.com.br/organize-seu-codigo-javascript-de-maneira-facil/">http://blog.caelum.com.br/organize-seu-codigo-javascript-de-maneira-facil/</a></a></em>
<br><br><br><br></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>
<!-- hackish -->

  
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
  
    <h1 class="title"><a href="/bye-bye-gruntjs-hello-gulpjs/">Bye bye Grunt.js, hello Gulp.js!</a></h1>
  

      
        <p class="published">
          Published: <time datetime="2014-01-14T11:26:27.000Z">Jan 14 2014</time>
        </p>
      
    </header>
    <div class="entry">
      
        <p>No ano passado, um enxurrada de projetos baseados em JavaScript apareceu no mercado. Grande parte disto deve-se ao fato da linguagem não estar restritamente ligada apenas ao ambiente dos navegadores, e sem dúvidas a plataforma do <strong>Node.js</strong> contribuiu demais para a expansão de todo esse ecossistema.</p>
<p>No balanço da onda, surgiram alternativas para ferramentas tradicionais de build (Maven, Ant e afins) e entre estas a que mais se destacou foi sem dúvidas o <strong>Grunt.js</strong> - e você pode acompanhar o beabá desse cara num <a href="http://blog.caelum.com.br/automacao-de-build-de-front-end-com-grunt-js/" target="_blank">excelente post publicado pelo Sérgio Lopes  no blog da Caelum</a>.</p>
<p>O <strong>Grunt.js</strong> é uma ferramenta fantástica, mais requer do desenvolvedor alguns conhecimentos que nem todo mundo está verdadeiramente por dentro, como por exemplo o perfeito entendimento da sintaxe literal para construção de objetos que é a base da organização do <strong>Grunt</strong>.</p>
<p><img src="http://blog.caelum.com.br/wp-content/uploads/2014/01/Screen-Shot-2014-01-11-at-12.33.56-AM-300x170.png" alt="" style="display:block;margin:auto;" /></p>
<p>A idéia do <strong>Gulp.js</strong> é abstrair esse conhecimento e trabalhar de uma forma muito mais digamos &quot;jQuery like&quot;, onde você vai precisar conhecer meia dúzia de métodos e ele por trás faz a abstração dos detalhes necessários para a geração do build.</p>
<h2 id="come-ando-com-o-gulp-js">Começando com o Gulp.js</h2>
<p>Assim como o <strong>Grunt</strong>, o <strong>Gulp</strong> é uma ferramenta de automação de tarefas feita em JavaScript e rodando em cima do <strong>Node.js</strong>. Como o core da execução é o Node, precisamos começar nossos trabalhos definindo o arquivo de vai gerenciar os módulos <strong>Gulp</strong> que você utilizará no seu projeto. Para isto, você deve criar na raiz do mesmo o arquivo <strong>package.json</strong>.</p>
<p>A forma mais fácil de fazer isso, é utilizando a seguinte instrução no terminal:</p>
<figure class="highlight terminal"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="variable">$ </span>npm init
</pre></td></tr></table></figure>

<p>Esse comando questionará o desenvolvedor sobre uma série de detalhes do projeto (nome, versão, descrição, repositório no git, palavras chaves, autor, licença, etc). Você pode fornecer os detalhes ou ir pressionando Enter e deixar que gerenciador faça as definições baseado em algumas sugestões para as chaves indicadas. No final, o gerenciador exibirá uma amostra do JSON que foi definido e solicitará a sua confirmação para gravação do <strong>package.json</strong>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre>{
  <span class="string">"name"</span>: <span class="string">"gulpteste"</span>,
  <span class="string">"version"</span>: <span class="string">"0.0.0"</span>,
  <span class="string">"description"</span>: <span class="string">""</span>,
  <span class="string">"main"</span>: <span class="string">"index.js"</span>,
  <span class="string">"scripts"</span>: {
    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" && exit 1"</span>
  },
  <span class="string">"author"</span>: <span class="string">""</span>,
  <span class="string">"license"</span>: <span class="string">"ISC"</span>
}
</pre></td></tr></table></figure>

<p>Ai basta digitar um &quot;yes&quot; e ser feliz!</p>
<h2 id="instalando-os-m-dulos">Instalando os módulos</h2>
<p>Essa parte é a mais fácil. Baseada nas tarefas que você gostaria de automatizar, será necessário instalar os módulos do <strong>Gulp</strong>. No nosso exemplo, faremos um procedimento simples, de minificação de arquivos em JavaScript utilizando o <strong>Uglify</strong>. Então além dos módulos que farão o gulp funcionar (<strong>gulp e gulp-util</strong>), você precisará instalar o módulo da minificação (<strong>gulp-uglify</strong>) e de quebra instalaremos também um módulo para monitorar alterações nos arquivos .js e rodará a tarefa da minificação (<strong>gulp-watch</strong>)</p>
<figure class="highlight terminal"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>$ npm install gulp <span class="subst">--</span>save<span class="attribute">-dev</span>
$ npm install gulp<span class="attribute">-util</span> <span class="subst">--</span>save<span class="attribute">-dev</span>
$ npm install gulp<span class="attribute">-uglify</span> <span class="subst">--</span>save<span class="attribute">-dev</span>
$ npm install gulp<span class="attribute">-watch</span> <span class="subst">--</span>save<span class="attribute">-dev</span>
</pre></td></tr></table></figure>

<p>Note que para cada módulo instalado, utilizamos o parâmetro <strong>--save-dev</strong>. Isto modificará nosso arquivo package.json adicionando ao mesmo os módulos que a partir de agora são dependências para rodarmos as tarefas do <strong>Gulp</strong>. Se você for curioso, pode expiar o conteúdo do <strong>package.json</strong>, ele deve estar assim:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre>{
  <span class="string">"name"</span>: <span class="string">"gulpteste"</span>,
  <span class="string">"version"</span>: <span class="string">"0.0.0"</span>,
  <span class="string">"description"</span>: <span class="string">""</span>,
  <span class="string">"main"</span>: <span class="string">"index.js"</span>,
  <span class="string">"scripts"</span>: {
    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" && exit 1"</span>
  },
  <span class="string">"author"</span>: <span class="string">""</span>,
  <span class="string">"license"</span>: <span class="string">"ISC"</span>,
  <span class="string">"devDependencies"</span>: {
    <span class="string">"gulp"</span>: <span class="string">"~3.3.0"</span>,
    <span class="string">"gulp-util"</span>: <span class="string">"~2.2.9"</span>,
    <span class="string">"gulp-uglify"</span>: <span class="string">"~0.1.0"</span>,
    <span class="string">"gulp-watch"</span>: <span class="string">"~0.3.3"</span>
  }
}
</pre></td></tr></table></figure>

<p>A grande vantagem de instalar os módulos desta maneira, é a fácil reinstalação de todas as dependências. Imagine que inadvertidamente alguém apagou a pasta <strong>node_modules</strong> do seu projeto. Ou mesmo, imagine que você gostaria de compartilhar este projeto com outro desenvolvedor. Não há a mínima necessidade de versionar a pasta <strong>node_modules</strong>. Basta ter o <strong>package.json</strong> atualizado e uma única instrução fará que com que tudo volte ao normal. A título de teste, exclua agora sua pasta <strong>node_modules</strong>... da até uma tristeza né, afinal você terá que reinstalar tudo novamente. A boa notícia é que agora tudo será bem mais facil, bastando rodar um:</p>
<figure class="highlight terminal"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="variable">$ </span>npm install
</pre></td></tr></table></figure>

<p>Pronto! Tudo voltou a ordem que estava anteriormente.</p>
<h2 id="configurando-suas-tarefas">Configurando suas tarefas</h2>
<p>Para rodar o Gulp.js, você vai precisar configurar as tarefas que serão executadas. A título de exemplo, vamos criar 2 pastas, uma chamada <strong>src</strong> e outra chamada <strong>build</strong>, na raiz do projeto.</p>
<p>Dentro da pasta <strong>src</strong>, vamos criar uma pasta <strong>js</strong> onde ficarão todos os arquivos originais de desenvolvimento.</p>
<p>Com a automatização, será criada automaticamente uma pasta <strong>js</strong> dentro de <strong>build</strong>, com os arquivos js que estão na pasta <strong>src</strong>, porém estes últimos estarão minificados pelo <strong>Uglify</strong>. Para essa mágica toda acontecer, vamos criar na raiz o arquivo de configuração das tarefas, o <strong>gulpfile.js</strong>.</p>
<p>Abra o arquivo e mãos a obra. O primeiro passo é instanciar os módulos que vamos utilizar:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="comment">// instanciando módulos</span>
<span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);
<span class="keyword">var</span> gutil = <span class="built_in">require</span>(<span class="string">'gulp-util'</span>);
<span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);
<span class="keyword">var</span> watch = <span class="built_in">require</span>(<span class="string">'gulp-watch'</span>);
</pre></td></tr></table></figure>

<p>A primeira tarefa que vamos definir, é que vai minificar os arquivos da pasta <code>src/js</code> para pasta <code>build/js</code>. Para isto, utilizaremos o método <code>gulp.task()</code>, que recebe 2 parâmetros. O primeiro é o <strong>nome da nova tarefa</strong> e o segundo uma <strong>função callback</strong> com os steps que devem ser executados a partir desta:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>gulp.task(<span class="string">'scripts'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="comment">// corpo da tarefa</span>
});
</pre></td></tr></table></figure>

<p>Para configurar a minificação, precisamos definir 3 ações:</p>
<ol>
<li><em>recuperar os arquivos fonte na pasta de origem;</em></li>
<li><em>aplicar a minificação (uglify);</em></li>
<li><em>colocar o resultado na pasta de destino.</em></li>
</ol>
<p>O código ficará assim:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>gulp.task(<span class="string">'scripts'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="comment">// corpo da tarefa </span>
    <span class="keyword">return</span> gulp
            .src([<span class="string">'src/js/**/*.js'</span>])
            .pipe(uglify())
            .pipe(gulp.dest(<span class="string">'build/js'</span>));      
});
</pre></td></tr></table></figure>

<p>Pronto! Para rodá-la, podemos ir ao terminal e digitar:</p>
<figure class="highlight terminal"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="variable">$ </span>gulp scripts
</pre></td></tr></table></figure>

<p>E conferir se os arquivos foram minificados em <code>build/js</code>.</p>
<p>Para deixar a coisa mais legal, vamos configurar a tarefa que vai monitorar alterações na pasta <code>src/js</code> e rodar a tarefa &#39;scripts&#39;, responsável pela minificação. Começamos da mesma forma:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
   <span class="comment">// corpo da tarefa </span>
});
</pre></td></tr></table></figure>

<p>Dentro da nova task, vamos utilizar o método <code>gulp.watch()</code> que recebe 2 parâmetros. No primeiro, definimos a <strong>pasta onde estão os nossos arquivos fonte</strong> e um <strong>função callback</strong> que será executada toda vez que um desses arquivos for modificado:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="comment">// corpo da tarefa </span>
    gulp.watch(<span class="string">'src/js/**/*.js'</span>, <span class="function"><span class="keyword">function</span><span class="params">(event)</span> {</span>});
});
</pre></td></tr></table></figure>

<p>Agora no callback, o método <code>gutil.log()</code> exibirá informações do arquivo alterado, e através do método <code>gulp.run()</code> definimos qual tarefa será executada. Isso acontecerá toda vez que um arquivo presente em <code>src/js</code> for alterado:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="comment">// corpo da tarefa </span>
    gulp.watch(<span class="string">'src/js/**/*.js'</span>, <span class="function"><span class="keyword">function</span><span class="params">(event)</span> {</span>
        gutil.log(<span class="string">'File '</span>+event.path+<span class="string">' was '</span>+event.type+<span class="string">', running tasks...'</span>);
        gulp.run(<span class="string">'scripts'</span>);
    });
});
</pre></td></tr></table></figure>

<p>Vamos conferir, no terminal execute:</p>
<figure class="highlight terminal"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="variable">$ </span>gulp watch
</pre></td></tr></table></figure>

<p>Ai basta alterar qualquer arquivo .js da pasta fonte e ver o resultado na pasta <code>build/js</code>.</p>
<h2 id="indo-al-m">Indo além</h2>
<p>Agora que temos uma boa noção como tudo funciona, basta repetir o ciclo. Para cada nova tarefa que for automatizar, siga estes passos:</p>
<ol>
<li><em>instale o novo módulo usando npm install;</em></li>
<li><em>instancie o novo módulo no gulpfile.js;</em></li>
<li><em>defina a nova task e o que a mesma executará;</em></li>
<li><em>teste e divirta-se!</em></li>
</ol>
<p>Conheça mais sobre o projeto, visitando o <a href="http://gulpjs.com/" target="_blank">site oficial</a>. Dê uma olhada no <a href="http://gratimax.github.io/search-gulp-plugins/" target="_blank">link plugins</a>, lá você vai descobrir uma série de módulos para utilizar com o Gulp.js</p>
<p>Se você quiser saber mais sobre o processo de automatização de tarefas de front-end (utilizando Grunt.js), não deixe deixe de conhecer <a href="http://www.caelum.com.br/curso-javascript-jquery/" target="_blank">o treinamento de Programação JavaScript da Caelum</a> . Te vejo por lá!</p>
<p><em>Este artigo foi originalmente publicado no site <a href="http://blog.caelum.com.br/bye-bye-grunt-js-hello-gulp-js/" target="_blank"><a href="http://blog.caelum.com.br/bye-bye-grunt-js-hello-gulp-js/">http://blog.caelum.com.br/bye-bye-grunt-js-hello-gulp-js/</a></a></em></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>
<!-- hackish -->

  

  <nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav>
</div>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 Leonardo Souza
  
</div>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>